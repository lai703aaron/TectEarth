<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GeoDrift｜板塊漂移時空機</title>

  <!-- Three.js (reliable CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.168.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.168.0/examples/js/controls/OrbitControls.js"></script>

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { overflow:hidden; background:#000; font-family:system-ui, sans-serif; color:#fff; }
    #container { position:fixed; top:0; left:0; width:100vw; height:100vh; }

    .ui {
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.75);
      padding: 25px 50px;
      border-radius: 30px;
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255,100,0,0.6);
      text-align: center;
      box-shadow: 0 15px 50px rgba(0,0,0,0.8);
      z-index: 10;
    }
    h1 {
      font-size: 3em;
      background: linear-gradient(90deg, #ff6b00, #ff9500, #00e7ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }
    #timeLabel {
      font-size: 1.9em;
      font-weight: bold;
      color: #00ffcc;
      text-shadow: 0 0 15px #00ffcc;
      margin: 15px 0;
    }
    #timeSlider {
      width: 100%;
      height: 16px;
      border-radius: 10px;
      background: #222;
      outline: none;
      margin: 20px 0;
      -webkit-appearance: none;
    }
    #timeSlider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 34px; height: 34px;
      border-radius: 50%;
      background: #ff6b00;
      cursor: pointer;
      box-shadow: 0 0 25px #ff6b00;
    }
    button {
      margin: 12px;
      padding: 14px 32px;
      background: #ff6b00;
      border: none;
      border-radius: 30px;
      color: white;
      font-size: 1.1em;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover { background:#ff9500; transform:scale(1.1); }
    .info { margin-top:15px; opacity:0.9; font-size:0.95em; }
  </style>
</head>
<body>

  <div id="container"></div>

  <div class="ui">
    <h1>GeoDrift</h1>
    <div id="timeLabel">現在 (0 Ma)</div>
    <input type="range" id="timeSlider" min="-600" max="250" value="0" step="10">
    <div>
      <button id="playBtn">播放動畫</button>
      <button id="resetBtn">回到現在</button>
    </div>
    <p class="info">拖動時間軸，從盤古大陸到未來超大陸，探索6億年板塊漂移！</p>
  </div>

  <script>
    let scene, camera, renderer, earth, controls;
    let isPlaying = false, direction = 1;

    const textures = {
      "-600": "https://i.imgur.com/2f5mK8J.jpg",
      "-540": "https://i.imgur.com/8Y3vXpL.jpg",
      "-450": "https://i.imgur.com/QkR8mP0.jpg",
      "-335": "https://i.imgur.com/X7pL9sN.jpg",
      "-250": "https://i.imgur.com/4r9vZkE.jpg",
      "-200": "https://i.imgur.com/J8sL2pX.jpg",  // Pangea
      "-150": "https://i.imgur.com/oP7nR5v.jpg",
      "-100": "https://i.imgur.com/W2kX9mZ.jpg",
      "-50":  "https://i.imgur.com/9tY5vHq.jpg",
      "0":    "https://i.imgur.com/0vL8g7P.jpg",  // Modern Earth
      "50":   "https://i.imgur.com/L5pR9kD.jpg",
      "100":  "https://i.imgur.com/H3mX2vN.jpg",
      "250":  "https://i.imgur.com/Z9kP7wQ.jpg"   // Future Amasia
    };

    function init() {
      scene = new THREE.Scene();
      scene.background = new THREE.Color(0x000814);

      camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
      camera.position.set(0, 0, 4.5);

      renderer = new THREE.WebGLRenderer({antialias:true});
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(window.devicePixelRatio);
      document.getElementById('container').appendChild(renderer.domElement);

      controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.07;

      const geo = new THREE.SphereGeometry(2, 128, 128);
      const mat = new THREE.MeshPhongMaterial({
        map: new THREE.TextureLoader().load(textures["0"]),
        bumpScale: 0.08,
        shininess: 25
      });
      earth = new THREE.Mesh(geo, mat);
      scene.add(earth);

      scene.add(new THREE.AmbientLight(0x404040, 1.2));
      const sun = new THREE.DirectionalLight(0xffffff, 1.8);
      sun.position.set(5, 3, 5);
      scene.add(sun);

      // UI events
      const slider = document.getElementById('timeSlider');
      slider.addEventListener('input', e => updateTime(parseInt(e.target.value)));
      document.getElementById('playBtn').addEventListener('click', () => {
        isPlaying = !isPlaying;
        document.getElementById('playBtn').textContent = isPlaying ? '暫停' : '播放動畫';
      });
      document.getElementById('resetBtn').addEventListener('click', () => {
        slider.value = 0;
        updateTime(0);
        isPlaying = false;
        document.getElementById('playBtn').textContent = '播放動畫';
      });

      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth/window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });

      animate();
    }

    function updateTime(ma) {
      const keys = Object.keys(textures).map(Number).sort((a,b)=>a-b);
      const closest = keys.reduce((a,b)=> Math.abs(b-ma)<Math.abs(a-ma)?b:a);
      new THREE.TextureLoader().load(textures[closest], tex => {
        earth.material.map = tex;
        earth.material.needsUpdate = true;
      });
      const label = ma < 0 ? `${Math.abs(ma)} 百萬年前` : ma > 0 ? `未來 ${ma} 百萬年` : "現在";
      document.getElementById('timeLabel').textContent = label;
    }

    function animate() {
      requestAnimationFrame(animate);
      controls.update();
      earth.rotation.y += 0.003;

      if (isPlaying) {
        let val = parseInt(document.getElementById('timeSlider').value) + direction * 8;
        if (val >= 250 || val <= -600) direction *= -1;
        document.getElementById('timeSlider').value = val;
        updateTime(val);
      }

      renderer.render(scene, camera);
    }

    init();
  </script>
</body>
</html>
